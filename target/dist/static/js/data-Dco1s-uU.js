import{i as f}from"./index-BzwtatPw.js";import"./store-BGvsPsWR.js";import{u as W}from"./index-OBXFyj3D.js";import{b as B,a as b}from"./element-plus-DaJS5H-O.js";import{d as w,ap as E,Y as o,$ as N,o as h,J as v,K as s,i as e,L as j,O as D}from"./@vue.runtime-core-B2X3lOUZ.js";import{u as y}from"./@vue.reactivity-V6IlnEmz.js";import"./@vue.runtime-dom-DkKQpP1Z.js";import"./@vue.shared-D-bMerGS.js";import"./@vueuse.core-Bp0bPelK.js";import"./@vueuse.shared-CZpoHp70.js";import"./lodash-es-I-EvhVFk.js";import"./mitt-C1z4c41a.js";import"./axios-CvWkLj0m.js";import"./nprogress-B7fG2QpQ.js";import"./chardet-C_72lc3Z.js";import"./pinia-ByvooDwk.js";import"./vue-demi-Dq6ymT-8.js";import"./monaco-editor-CuOEaJz6.js";import"./vue-echarts-BbwyaQnR.js";import"./resize-detector-CZu9PX2v.js";import"./echarts-Bv2MlBtc.js";import"./tslib-BDyQ-Jie.js";import"./zrender-BSc91FC-.js";import"./vue-router-4IlAtr41.js";import"./mockjs-Bfc9hT_P.js";import"./dayjs-DOBku9Nj.js";import"./vue-xN6KRtQP.js";import"./@element-plus.icons-vue-BCFYf-67.js";import"./@popperjs.core-D9SI2xQl.js";import"./@ctrl.tinycolor-r5W6hzzQ.js";import"./async-validator-CRbnkQr6.js";import"./memoize-one-BdPwpGay.js";import"./normalize-wheel-es-B6fDCfyv.js";import"./@floating-ui.dom-B8Qxuwjg.js";import"./@floating-ui.core-DTrSsA1T.js";import"./@floating-ui.utils-Bh-IyuRp.js";const M=w({name:"recycle-data"}),he=w({...M,setup(O){const{service:i}=W(),p=f.useTable({columns:[{type:"selection"},{label:"操作人",prop:"userName",minWidth:120},{label:"被删除的数据",prop:"data",minWidth:200,component:{name:"cl-code-json",props:{popover:!0}}},{label:"请求的接口",prop:"url",showOverflowTooltip:!0,minWidth:150},{label:"请求参数",prop:"params",minWidth:150,component:{name:"cl-code-json",props:{popover:!0}}},{label:"删除条数",prop:"count",minWidth:120,sortable:"custom"},{label:"创建时间",prop:"createTime",minWidth:160,sortable:"desc"},{type:"op",width:120,buttons:[{label:"恢复",hidden:!i.recycle.data._permission.restore,type:"success",onClick({scope:t}){_(t.row.id)}}]}]}),a=f.useCrud({service:i.recycle.data});function m(t){var r;(r=a.value)==null||r.refresh(t)}function _(t){var c;const r=t?[t]:(c=p.value)==null?void 0:c.selection.map(n=>n.id);B.confirm("此操作将恢复被删除的数据，是否继续？","提示",{type:"warning"}).then(()=>{i.recycle.data.restore({ids:r}).then(()=>{b.success("数据恢复成功"),m()}).catch(n=>{b.error(n.message)})}).catch(()=>null)}return E(()=>{m()}),(t,r)=>{const c=o("cl-refresh-btn"),n=o("el-button"),u=o("cl-flex1"),x=o("cl-search-key"),l=o("cl-row"),C=o("cl-table"),k=o("cl-pagination"),g=o("cl-crud"),T=N("permission");return h(),v(g,{ref_key:"Crud",ref:a},{default:s(()=>[e(l,null,{default:s(()=>{var d;return[e(c),j((h(),v(n,{type:"success",disabled:((d=y(p))==null?void 0:d.selection.length)==0,onClick:r[0]||(r[0]=V=>_())},{default:s(()=>[D("批量恢复")]),_:1},8,["disabled"])),[[T,y(i).recycle.data.permission.restore]]),e(u),e(x)]}),_:1}),e(l,null,{default:s(()=>[e(C,{ref_key:"Table",ref:p},null,512)]),_:1}),e(l,null,{default:s(()=>[e(u),e(k)]),_:1})]),_:1},512)}}});export{he as default};
