import{u as B,m as Z,a as tt,i as et}from"./index-BzwtatPw.js";import"./store-BGvsPsWR.js";import{u as P}from"./index-OBXFyj3D.js";import{n as ot,Q as nt}from"./@element-plus.icons-vue-BCFYf-67.js";import{h as st,C as q,r as at,B as lt}from"./lodash-es-I-EvhVFk.js";import{d as $,t as T,Y as v,o as i,c as b,J as S,K as y,F as D,V as z,O as rt,q as G,i as c,N as L,a as n,e as j,av as J,au as Q,M as U,y as ct,h as W,L as it,f as pt,a4 as ut}from"./@vue.runtime-core-B2X3lOUZ.js";import{u as d,r as X,k as _t,m as dt}from"./@vue.reactivity-V6IlnEmz.js";import{O as N,o as A}from"./@vue.shared-D-bMerGS.js";import{_ as F}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{a as mt,b as ft}from"./element-plus-DaJS5H-O.js";import{_ as ht}from"./logo-CxXS7KxG.js";import{v as vt,w as Y,T as bt}from"./@vue.runtime-dom-DkKQpP1Z.js";import"./@vueuse.core-Bp0bPelK.js";import"./@vueuse.shared-CZpoHp70.js";import"./mitt-C1z4c41a.js";import"./axios-CvWkLj0m.js";import"./nprogress-B7fG2QpQ.js";import"./chardet-C_72lc3Z.js";import"./pinia-ByvooDwk.js";import"./vue-demi-Dq6ymT-8.js";import"./monaco-editor-CuOEaJz6.js";import"./vue-echarts-BbwyaQnR.js";import"./resize-detector-CZu9PX2v.js";import"./echarts-Bv2MlBtc.js";import"./tslib-BDyQ-Jie.js";import"./zrender-BSc91FC-.js";import"./vue-router-4IlAtr41.js";import"./mockjs-Bfc9hT_P.js";import"./dayjs-DOBku9Nj.js";import"./vue-xN6KRtQP.js";import"./@popperjs.core-D9SI2xQl.js";import"./@ctrl.tinycolor-r5W6hzzQ.js";import"./async-validator-CRbnkQr6.js";import"./memoize-one-BdPwpGay.js";import"./normalize-wheel-es-B6fDCfyv.js";import"./@floating-ui.dom-B8Qxuwjg.js";import"./@floating-ui.core-DTrSsA1T.js";import"./@floating-ui.utils-Bh-IyuRp.js";const wt={class:"route-nav"},kt={key:0,class:"route-nav__title"},$t=$({name:"route-nav"}),yt=$({...$t,setup(p){const{route:l,browser:m}=P(),{menu:u}=B(),s=T(()=>{function r(e){if(l.path==="/")return!1;if(e.path==l.path)return e;if(e.children){const a=e.children.map(r).find(Boolean);return a?[e,a]:!1}else return!1}return st(u.group.map(r).filter(Boolean))}),w=T(()=>{var r;return(r=q(s.value))==null?void 0:r.name});return(r,e)=>{const a=v("el-breadcrumb-item"),o=v("el-breadcrumb");return i(),b("div",wt,[d(m).isMini?(i(),b("p",kt,N(w.value),1)):(i(),S(o,{key:1,"separator-icon":d(ot)},{default:y(()=>[(i(!0),b(D,null,z(s.value,(t,_)=>(i(),S(a,{key:_},{default:y(()=>{var k;return[rt(N(((k=t.meta)==null?void 0:k.label)||t.name),1)]}),_:2},1024))),128))]),_:1},8,["separator-icon"]))])}}}),gt=F(yt,[["__scopeId","data-v-c12fbba9"]]),xt={class:"a-menu"},Ct={class:"a-menu__name"},Mt=$({name:"a-menu"}),St=$({...Mt,setup(p){const{router:l,route:m}=P(),{menu:u}=B(),s=X("0"),w=T(()=>u.group.filter(a=>a.isShow));function r(a){var _;if(String(a)==s.value)return!1;const o=w.value[a],t=u.getPath(o);t?(u.setMenu(a),l.push(t)):mt.warning(`“${(_=o.meta)==null?void 0:_.label}”下没有菜单，请先添加`)}function e(){let a=0;function o(t,_){switch(t.type){case 0:t.children&&t.children.forEach(k=>{o(k,_)});break;case 1:m.path.includes(t.path)&&(a=_);break}}w.value.forEach(o),s.value=String(a),u.setMenu(a)}return G(()=>[m.path,u.group.length],()=>{e()},{immediate:!0}),(a,o)=>{const t=v("cl-svg"),_=v("el-menu-item"),k=v("el-menu");return i(),b("div",xt,[c(k,{"default-active":s.value,mode:"horizontal","background-color":"transparent",onSelect:r},{default:y(()=>[(i(!0),b(D,null,z(w.value,(g,C)=>(i(),S(_,{key:g.id,index:`${C}`},{default:y(()=>{var x;return[g.icon?(i(),S(t,{key:0,name:g.icon,size:18},null,8,["name"])):L("",!0),n("span",Ct,N((x=g.meta)==null?void 0:x.label),1)]}),_:2},1032,["index"]))),128))]),_:1},8,["default-active"])])}}}),Bt=F(St,[["__scopeId","data-v-e2d4ff6b"]]),R=p=>(J("data-v-47f133af"),p=p(),Q(),p),It={class:"app-topbar"},Nt=R(()=>n("i",{class:"cl-iconfont cl-icon-fold"},null,-1)),Pt=[Nt],Ft=R(()=>n("div",{class:"flex1"},null,-1)),Rt={class:"app-topbar__tools"},Vt={key:0,class:"app-topbar__user"},Et={class:"el-dropdown-link"},Tt={class:"name"},Dt=R(()=>n("i",{class:"cl-iconfont cl-icon-user"},null,-1)),Lt=R(()=>n("span",null,"个人中心",-1)),zt=R(()=>n("i",{class:"cl-iconfont cl-icon-exit"},null,-1)),Ot=R(()=>n("span",null,"退出",-1)),jt=$({name:"app-topbar"}),At=$({...jt,setup(p){const{router:l,service:m,browser:u}=P(),{user:s,app:w}=B();async function r(o){switch(o){case"my":l.push("/my/info");break;case"exit":ft.confirm("确定退出登录吗？","提示",{type:"warning"}).then(async()=>{await m.base.comm.logout(),s.logout()}).catch(()=>null);break}}const e=_t({list:[],async init(){const o=at(Z.list.map(t=>t.toolbar).filter(Boolean),"order");this.list=await Promise.all(o.map(async t=>{if(t){const _=await(lt(t.component)?t.component():t.component);return{...t,component:dt(_.default)}}}))}}),a=T(()=>e.list.filter(o=>u.isMini?(o==null?void 0:o.h5)??!0:(o==null?void 0:o.pc)??!0));return j(()=>{e.init()}),(o,t)=>{const _=v("cl-avatar"),k=v("el-dropdown-item"),g=v("el-dropdown-menu"),C=v("el-dropdown");return i(),b(D,null,[d(w).info.menu.isGroup?(i(),S(Bt,{key:0})):L("",!0),n("div",It,[n("div",{class:A(["app-topbar__collapse",{unfold:!d(w).isFold}]),onClick:t[0]||(t[0]=x=>d(w).fold())},Pt,2),c(gt),Ft,n("ul",Rt,[(i(!0),b(D,null,z(a.value,(x,f)=>(i(),b("li",{key:f},[(i(),S(U(x.component)))]))),128))]),d(s).info?(i(),b("div",Vt,[c(C,{trigger:"click","hide-on-click":"",onCommand:r},{dropdown:y(()=>[c(g,null,{default:y(()=>[c(k,{command:"my"},{default:y(()=>[Dt,Lt]),_:1}),c(k,{command:"exit"},{default:y(()=>[zt,Ot]),_:1})]),_:1})]),default:y(()=>[n("span",Et,[n("span",Tt,N(d(s).info.nickName),1),c(_,{size:32,src:d(s).info.headImg},null,8,["src"])])]),_:1})])):L("",!0)])],64)}}}),Ht=F(At,[["__scopeId","data-v-47f133af"]]);function Kt(p){return typeof p=="function"||Object.prototype.toString.call(p)==="[object Object]"&&!ct(p)}const Wt=$({name:"b-menu",setup(){const{router:p,route:l,browser:m}=P(),{menu:u,app:s}=B();function w(e){e!=l.path&&p.push(e),m.isMini&&s.fold(!0)}function r(){function e(a,o){return a.filter(t=>t.isShow).map(t=>{var g;let _=null;const k=C=>{var x;return c("div",{class:"wrap"},[c(v("cl-svg"),{name:C.icon},null),it(c("span",null,[(x=C.meta)==null?void 0:x.label]),[[vt,!s.isFold||o!=1]])])};return t.type==0?_=W(c(v("el-sub-menu"),null,null),{index:String(t.id),key:t.id,popperClass:"app-slider__menu"},{title(){return k(t)},default(){return e(t.children||[],o+1)}}):_=W(c(v("el-menu-item"),null,null),{index:l.path=="/"&&(g=t.meta)!=null&&g.isHome?"/":t.path,key:t.id},{default(){return k(t)}}),_})}return e(u.list,1)}return()=>{let e;return c("div",{class:"app-slider__menu"},[c(v("el-menu"),{"default-active":l.path,"background-color":"transparent","collapse-transition":!1,collapse:m.isMini?!1:s.isFold,onSelect:w},Kt(e=r())?e:{default:()=>[e]})])}}}),Yt={class:"app-slider"},qt={class:"app-slider__logo"},Gt=n("img",{src:ht},null,-1),Jt={key:0},Qt={class:"app-slider__container"},Ut=$({name:"app-slider"}),Xt=$({...Ut,setup(p){const{browser:l}=tt(),{app:m}=B();return(u,s)=>(i(),b("div",Yt,[n("div",qt,[Gt,!d(m).isFold||d(l).isMini?(i(),b("span",Jt,N(d(m).info.name),1)):L("",!0)]),n("div",Qt,[c(d(Wt))])]))}}),H=p=>(J("data-v-882a9c6c"),p=p(),Q(),p),Zt={class:"app-process"},te=H(()=>n("i",{class:"cl-iconfont cl-icon-back"},null,-1)),ee=[te],oe=H(()=>n("i",{class:"cl-iconfont cl-icon-refresh"},null,-1)),ne=[oe],se=H(()=>n("i",{class:"cl-iconfont cl-icon-home"},null,-1)),ae=[se],le={class:"app-process__container"},re=["data-index","onClick","onContextmenu"],ce=$({name:"app-process"}),ie=$({...ce,setup(p){const{refs:l,setRefs:m,route:u,router:s,mitt:w}=P(),{process:r}=B();function e(){w.emit("view.refresh")}function a(){s.push("/")}function o(){s.back()}function t(){if(!r.list.find(h=>h.active)){const h=q(r.list);s.push(h?h.fullPath:"/")}}function _(f){l.scroller.wrapRef.scrollTo({left:f,behavior:"smooth"})}function k(f){const h=l[`item-${f}`];h&&_(h.offsetLeft-(l.scroller.wrapRef.clientWidth+h.clientWidth)/2)}function g(f,h){k(h),s.push(f.fullPath)}function C(f){r.remove(f),t()}function x(f,h){et.ContextMenu.open(f,{hover:{target:"app-process__item"},list:[{label:"关闭当前",hidden:h.fullPath!==u.path,callback(M){C(r.list.findIndex(V=>V.fullPath==h.fullPath)),M(),t()}},{label:"关闭其他",callback(M){r.set(r.list.filter(V=>V.fullPath==h.fullPath)),M(),t()}},{label:"关闭所有",callback(M){r.clear(),M(),t()}}]})}return G(()=>u.path,function(f){k(r.list.findIndex(h=>h.fullPath===f)||0)}),j(()=>{l.scroller.wrapRef.addEventListener("wheel",function(f){f.preventDefault();const M=f.deltaY*2;_(l.scroller.wrapRef.scrollLeft+M)})}),(f,h)=>{const M=v("el-icon"),V=v("el-scrollbar");return i(),b("div",Zt,[n("ul",{class:"app-process__op"},[n("li",{class:"item",onClick:o},ee),n("li",{class:"item",onClick:e},ne),n("li",{class:"item",onClick:a},ae)]),n("div",le,[c(V,{ref:d(m)("scroller"),class:"app-process__scroller"},{default:y(()=>[(i(!0),b(D,null,z(d(r).list,(I,E)=>{var K;return i(),b("div",{key:E,ref_for:!0,ref:d(m)(`item-${E}`),class:A(["app-process__item",{active:I.active}]),"data-index":E,onClick:O=>g(I,Number(E)),onContextmenu:Y(O=>x(O,I),["stop","prevent"])},[n("span",null,N(((K=I.meta)==null?void 0:K.label)||I.name||I.path),1),c(M,{onMousedown:Y(O=>C(Number(E)),["stop"])},{default:y(()=>[c(d(nt))]),_:2},1032,["onMousedown"])],42,re)}),128))]),_:1},512)])])}}}),pe=F(ie,[["__scopeId","data-v-882a9c6c"]]),ue={class:"app-views"},_e=$({name:"app-views"}),de=$({..._e,setup(p){const{mitt:l}=P(),{process:m,app:u}=B(),s=X(1),w=T(()=>m.list.filter(e=>{var a;return(a=e.meta)==null?void 0:a.keepAlive}).map(e=>e.path.substring(1,e.path.length).replace(/\//g,"-")));function r(){s.value+=1}return j(()=>{l.on("view.refresh",r)}),pt(()=>{l.off("view.refresh")}),(e,a)=>{const o=v("router-view");return i(),b("div",ue,[c(o,null,{default:y(({Component:t})=>[c(bt,{name:d(u).info.router.transition||"none"},{default:y(()=>[(i(),S(ut,{include:w.value,key:s.value},[(i(),S(U(t)))],1032,["include"]))]),_:2},1032,["name"])]),_:1})])}}}),me=F(de,[["__scopeId","data-v-7dbd22c3"]]),fe={class:"app-layout__left"},he={class:"app-layout__right"},ve=$({name:"app-layout"}),be=$({...ve,setup(p){const{app:l}=B();return(m,u)=>(i(),b("div",{class:A(["app-layout",{collapse:d(l).isFold}])},[n("div",{class:"app-layout__mask",onClick:u[0]||(u[0]=s=>d(l).fold(!0))}),n("div",fe,[c(Xt)]),n("div",he,[c(Ht),c(pe),c(me)])],2))}}),no=F(be,[["__scopeId","data-v-8159229a"]]);export{no as default};
